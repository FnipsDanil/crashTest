# üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## –û–±–∑–æ—Ä
–°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã crash-–∏–≥—Ä—ã —á–µ—Ä–µ–∑ PostgreSQL –∏ API –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- **Decimal/float –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã**: –í—Å–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç Decimal –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –ì–°–ß –¥–ª—è crash_point
- **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏, Decimal –∏ —á–∏—Å–ª–∞–º–∏

## üìä –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```json
{
  "growth_rate": "1.01",          // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ—Å—Ç–∞ –∑–∞ —Ç–∏–∫ (1.0 - 1.1)
  "tick_ms": 60,                  // –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –º—Å (10-1000)
  "max_coefficient": "100.0",     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (10-1000)  
  "waiting_time": 10,             // –í—Ä–µ–º—è –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏ –≤ —Å–µ–∫ (1-60)
  "join_time": 2                  // –í—Ä–µ–º—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∏–≥—Ä—É –≤ —Å–µ–∫ (1-60)
}
```

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ crash_point
```json
{
  "crash_ranges": [
    {"min": "1.1", "max": "3.0", "probability": "0.7"},   // 70% –Ω–∏–∑–∫–∏–µ
    {"min": "3.0", "max": "10.0", "probability": "0.2"},  // 20% —Å—Ä–µ–¥–Ω–∏–µ  
    {"min": "10.0", "max": "50.0", "probability": "0.1"}  // 10% –≤—ã—Å–æ–∫–∏–µ
  ]
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –°—É–º–º–∞ –≤—Å–µ—Ö `probability` –¥–æ–ª–∂–Ω–∞ —Ä–∞–≤–Ω—è—Ç—å—Å—è 1.0 (¬±0.001)
- –î–∏–∞–ø–∞–∑–æ–Ω—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å—Å—è
- `min < max` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞

## üîß API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```bash
GET /api/admin/game-config
```

### –û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```bash
PUT /api/admin/game-config
Content-Type: application/json

{
  "growth_rate": "1.015",
  "tick_ms": 40,
  "crash_ranges": [
    {"min": "1.1", "max": "2.5", "probability": "0.8"},
    {"min": "2.5", "max": "20.0", "probability": "0.2"}
  ]
}
```

### –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∏
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–æ–∫
GET /api/admin/game-config/presets

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∏
POST /api/admin/game-config/apply-preset/aggressive
POST /api/admin/game-config/apply-preset/conservative  
POST /api/admin/game-config/apply-preset/balanced
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
# –°–±—Ä–æ—Å –∫ –¥–µ—Ñ–æ–ª—Ç—É
POST /api/admin/game-config/reset

# –í–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
POST /api/admin/game-config/validate
Content-Type: application/json
{...config...}

# –¢–µ–∫—É—â–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ –ø–∞–º—è—Ç–∏
GET /api/admin/game-config/current-effective

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î
POST /api/admin/game-config/reload
```

## üéØ –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∏

### Conservative (–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è)
- **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ß–∞—Å—Ç—ã–µ –º–∞–ª—ã–µ –∫—Ä–∞—Ö–∏, –º–µ–Ω—å—à–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: 
  - growth_rate: "1.008" (–º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç)
  - tick_ms: 80 (—Ä–µ–¥–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
  - crash_ranges: 80% –¥–æ 2.5x, 15% –¥–æ 8x, 5% –¥–æ 30x

### Balanced (–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è) 
- **–†–∏—Å–∫**: –°—Ä–µ–¥–Ω–∏–π
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–µ—Ñ–æ–ª—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### Aggressive (–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è)
- **–†–∏—Å–∫**: –í—ã—Å–æ–∫–∏–π  
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ë—ã—Å—Ç—Ä—ã–π —Ä–æ—Å—Ç, –±–æ–ª—å—à–∏–µ –≤—ã–∏–≥—Ä—ã—à–∏
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - growth_rate: "1.012" (–±—ã—Å—Ç—Ä—ã–π —Ä–æ—Å—Ç)
  - tick_ms: 50 (—á–∞—Å—Ç—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)  
  - crash_ranges: 60% –¥–æ 2x, 25% –¥–æ 15x, 15% –¥–æ 100x

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è crash_point
- **–ò—Å—Ç–æ—á–Ω–∏–∫ —ç–Ω—Ç—Ä–æ–ø–∏–∏**: `secrets.SystemRandom()` (–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π)
- **–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å**:
  1. –í—ã–±–æ—Ä –¥–∏–∞–ø–∞–∑–æ–Ω–∞: —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ 0-1
  2. –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ: —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π crash_point –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–Ω—Ç—Ä–æ–ø–∏—é –û–°

### –ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
```python
# 1. –í—ã–±–∏—Ä–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω
rand = Decimal(str(secure_random.random()))  # 0.0-1.0
cumulative_prob = Decimal('0')

for range_config in crash_ranges:
    cumulative_prob += Decimal(str(range_config["probability"]))
    if rand <= cumulative_prob:
        # 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
        min_val = Decimal(str(range_config["min"]))
        max_val = Decimal(str(range_config["max"]))
        rand_uniform = Decimal(str(secure_random.random()))
        crash_point = min_val + (max_val - min_val) * rand_uniform
        return crash_point.quantize(Decimal('0.01'))
```

## üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### PostgreSQL `system_settings`
```sql
CREATE TABLE system_settings (
    key VARCHAR(100) PRIMARY KEY,
    value JSONB NOT NULL,
    description TEXT,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –ó–∞–ø–∏—Å—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
INSERT INTO system_settings (key, value, description) VALUES (
    'game_config', 
    '{"growth_rate": "1.01", "tick_ms": 60, ...}',
    'Game configuration settings'
);
```

### –§–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è
- **Decimal –∑–Ω–∞—á–µ–Ω–∏—è**: –•—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
- **–¶–µ–ª—ã–µ —á–∏—Å–ª–∞**: –•—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ —á–∏—Å–ª–∞
- **JSONB**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –∑–∞–ø—Ä–æ—Å–æ–≤

### –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
```python
# main.py
stored_config = await DatabaseService.get_system_setting(session, "game_config")
if stored_config:
    update_game_config(stored_config)  # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏ -> Decimal
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
cd backend
python test_config_simple.py
```

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫—É –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —Å—Ç—Ä–æ–∫ –≤ Decimal
- ‚úÖ –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å Decimal
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é —Å—É–º–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```
INFO - game.engine - üé≤ Secure crash point: 3.39 (range 3.0-10.0)
INFO - config.settings - ‚úÖ Game config loaded from PostgreSQL system_settings  
INFO - api.admin_routes - Game configuration updated via admin API
```

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- –°—Ä–µ–¥–Ω–∏–π crash_point –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π vs –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ crash_point
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üö® –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
1. **–î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é** –¥–ª—è admin API
2. **–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø—Ä–∞–≤–∞** –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. **–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º
4. **–°–æ–∑–¥–∞—Ç—å backup** –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
1. **–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å** —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –ø–∞–º—è—Ç–∏
2. **–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å** –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ dev —Å—Ä–µ–¥–µ

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
1. **–û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ crash_point
2. **–ê–ª–µ—Ä—Ç—ã** –ø—Ä–∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö  
3. **–ú–µ—Ç—Ä–∏–∫–∏** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ game engine

## üîÑ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –£–≤–µ–ª–∏—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä—ã
```bash
curl -X PUT http://localhost:8000/api/admin/game-config \
  -H "Content-Type: application/json" \
  -d '{
    "growth_rate": "1.02", 
    "tick_ms": 30
  }'
```

### –°–¥–µ–ª–∞—Ç—å –∏–≥—Ä—É –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π
```bash  
curl -X PUT http://localhost:8000/api/admin/game-config \
  -H "Content-Type: application/json" \
  -d '{
    "crash_ranges": [
      {"min": "1.5", "max": "2.5", "probability": "0.9"},
      {"min": "2.5", "max": "5.0", "probability": "0.1"}
    ]
  }'
```

### –û—Ç–∫–∞—Ç –∫ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º
```bash
curl -X POST http://localhost:8000/api/admin/game-config/apply-preset/conservative
```

---

**‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** 
–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞.